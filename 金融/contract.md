# contract 合约

# 基础概念

## 交易对(Trading Pair)

是指在交易所上，两种不同的资产之间的交易对应关系。

每个交易对通常包括一个基准资产(比如BTC、ETH或其他资产)和另一个交易资产(比如USDT、USD或其他资产)。

交易对表示用户可以用一种资产来交换另一种资产。

**交易对的表示方式**

表示方式通常以下两种方式

- `A/B`
- `A-B`

例如：

BTC/USDT: BTC对USDT，表示用BTC来交换USDT。

ETH-USDT: EHT对USDT，表示用ETC来交换USDT。

## 标的(Underlying/Instrument)

标的是你进行交易或投资的对象，比如：

- 股票（如 Tesla 股份）
- 期货合约（如原油期货）
- 期权合约（如某股票的看涨期权）
- 外汇、债券、ETF、衍生品等

示例场景：当您交易特斯拉股票的看涨期权时：

- 合约载体：期权合约本身（规定行权价/到期日等条款）
- 标的：特斯拉公司股票（NASDAQ: TSLA）
- 价值来源：特斯拉股价波动直接决定该期权价值

更实际一些，比如在合约场景，我想买入(做多)或卖出(做空)ETH资产，这个ETH资产就是标的。

## 仓位方向

仓位方向在计算赢亏、非常有用，另外它也表示交易得是什么仓位，规则如下

- 做多时仓位方向为 +1
- 做空时仓位方向为 -1

## 头寸(Positon)

头寸指的是你在某个标的(资产)上持有的仓位情况，包括

- 资产类型(哪个标的)
- 方向(多头或空头，也可以称为做多或做空)
- 数量(多少张合约或多少份资产)

头寸种类:

- 多头头寸: 看涨,表示持有资产
- 空头头寸: 看跌,表示卖空资产

大多数场景上头寸,代表”持仓“。

举例：

- 如果你买入(也就是做多)某个资产/股票/合约，则该标的(资产)就是多头头寸。
- 如果你卖出(也就是做空)某个资产/股票/合约，则该标的(资产)就是空头头寸。

## 做多(Long)

有的也有叫做**多头**,和做多一个意思。

做多的本质就是买入资产。当你预计某个标的的价格将要上涨时，你可以买入该标的；如果后续价格果然上涨，那么你将获得盈利。如果后续价格下跌，你将会亏损。

**例如:**

当前的eth价格为$3000,你预计价格将要上涨,那么你可以选择做多(买入)0.1个eth.此时你得仓位为+0.1(+号为仓位方向)个eth。

如果后续eth价格上涨至$3200,则你将获利 `0.1 * (3200 - 3000) = $20`,此时利润是浮动的(也称浮盈)，在没有平仓之前收益会随着价格的变化而变化。

如果后续eth价格下跌至$2800,则你将亏损 `0.1 * (2800 - 3000) = $-20`,此时亏损是浮动的(也称浮亏)，在没有平仓之前亏损会随着价格的变化而变化。

## 做空(Short)

有的也有叫**空头**,和做控一个意思。

做空的本质就是卖出资产。在合约交易中，即使你本身没有相应的标的，也可以先通过撮合交易借来标的来卖出，而在平仓时你需要根据平仓时的价格买回同样数量的标的，
还给原借出方。你可以通过预先借来得资产和平仓买入的价格差而获利。

当你预计某个标的价格将要下跌时，你可以借来该标的来卖出；
如果后续价格下跌，那么你只需要以较低的价格买回同样数量的标的还给借出方，从而盈利。
如果后续价格上涨，那你将不得不以较高得价格买回同样数量的标的还给借出方，从而亏损。

**例如:**

当前的eth价格为$3000,你预计价格将要下跌,那么你可以选择做空(卖出)0.1个eth.此时你得仓位为-0.1个eth(
这个-0.1代表仓位方向为做空)。

如果后续eth价格上涨至$3200,则你将亏损 `-0.1 * (3200 - 3000) = $-20`,此时亏损是浮动的(也叫浮亏)，在没有平仓之前亏损会随着价格变化的而变化。

如果后续eth价格下跌至$2800,则你将盈利 `-0.1 * (2800 - 3000) = $20`,此时利润是浮动的也叫浮盈)，在没有平仓之前盈利会随着价格变化的而变化。

## 平仓

无论是你在做多还是做空，此时你得利润会会随着价格不断变化。如果你想把把利润固定下来，此时你需要平仓操作，让你得仓位重新变成0。

在合约中卖出资产或买入资产就是平仓，只不过换个说法和名称。

### 做多的平仓

**本质**: 卖出已经买入的标的。简而言之低买高卖。

**例如：**

当前的eth价格为$3000,你选择做多(买入)0.1个eth.此时你得仓位为+0.1个eth。

如果后续eth价格上涨至$3200,此时你平仓(卖出)eth,则你将获利 `0.1 * (3200 - 3000) = $20`,此时利润是固定的而不是浮动的，收益则不会随着价格的变化而变化。

如果后续eth价格下跌至$2800,此时你平仓(卖出)eth,则你将亏损 `0.1 * (2800 - 3000) = $-20`,此时亏损是固定的而不是浮动的，亏损则不会随着价格的变化而变化。

### 做空的平仓

**本质**: 买回你提前卖出的、或借来的标的，以还给原来的借出方。

**例如：**

当前的eth价格为$3000,你选择做空(卖出)0.1个eth.此时你得仓位为-0.1个eth。

如果后续eth价格上涨至$3200,此时你平仓(买入) eth 则你将亏损 `-0.1 * (3200 - 3000) = $-20`,此时亏损是固定的而不是浮动的，亏损则不会随着价格的变化而变化。

如果后续eth价格下跌至$2800,此时你平仓(买入) eth 则你将盈利 `-0.1 * (2800 - 3000) = $20`,此时利润是固定的而不是浮动的，利润则不会随着价格的变化而变化。

## 仓位模式

- 单向持仓: 只能在同一合约中持有单一方向的仓位(即多仓或空仓)，不能同时持有多仓和空仓。
- 双向持仓: 也有叫**对冲模式**. 用户可以在同一个合约中同时持有多仓和空仓。

## 永续合约和交割合约

| 区别    | 永续合约                    | 交割合约                                                      |
|-------|-------------------------|-----------------------------------------------------------|
| 常见交易对 | BTC/USDT永续              | BTC/USDT当季0927                                            |
| 持有时间  | 无时间限制，可以永久不平仓           | 在9月27日前必须平仓,如果不平仓系统将强制根据当前价格平仓。                           |
| 资金费用  | 根据资金费率来计算               | 无资金费用                                                     |        
| 合约特性  | 一般情况下，永续合约价格和现货价格相差不会太大 | 在一些情况下，交割合约的价格会与现货有较大差距，某些情况下价格差距可能超过10%以上。直到交割日以现货价格进行平仓 |

## 杠杆(Leverage)

杠杆是指在合约中，你允许使用多倍数的资金来完成交易。例如10倍杠杆意味着用户可以用10倍于自己的保证金进行交易,增加潜在收益与风险。

一般杠杆倍数为1到100倍，有的交易所能到125倍，更甚者有到1000倍得。

总之风浪越大鱼越贵。

## 保证金模式(Margin Mode)

- **逐仓**: 每个仓位独立计算保证金，仓位亏损只影响该仓位中得保证金，不影响账户的其他部分资金。逐仓模式下，仓位的赢亏不能与其他仓位相对抵消。
  一旦其保证金亏损完，则该仓位爆仓，而其他仓位不受影响。
- **全仓**: 指用户将全部账户余额作为保证金的模式，如果发生亏损，会动用账户中全部资产作为风险抵押。全仓模式下，仓位的赢亏可与其他仓位相互抵消。一旦账户资金不足，则账户所有仓位爆仓。

优缺点:

|    | 优点            | 缺点       |
|----|---------------|----------|
| 逐仓 | 每个仓位分开计算,风险隔离 | 操作空间较小   |
| 全仓 | 较不容易爆仓库       | 一个爆仓全都爆仓 |

建议: 新手玩建议逐仓,避免所有资产爆仓。

保证金计算公式:

- 逐仓: `保证金 = todo`
- 全仓: `保证金 = 持仓数量 * 开仓价格 / 杠杆倍数`

另外保证金模式有一些其它类型，注意此处归类暂时放在这里有待商榷！！！

- 单币保证金模式: 仅使用单一币种作为保证金进行交易，适合专注某一种资产的用户。
- 联合保证金模式：多种资产可以作为保证金，分散风险，灵活性较高。需要考虑不同币种之间汇率换算问题。

## 手续费用模式

天下熙熙皆为利往. 在交易所买卖都会收取相应的手续费。手续费收取通常分为两种模式(来自sur.one介绍。):

- 盈利分成: 模式零交易手续费,无滑点。会从平仓利润中扣除一部分作为费用。
- 固定费率: 模式按交易量的固定比例收费，包含基础费率和滑点。

## 止盈/止损

## 下单方式

- 市价单：当场时长价格单
- 限价单：自己设定的价格单

优缺点

|     | 优点                    | 缺点                      |
|-----|-----------------------|-------------------------|
| 市价单 | 有滑点,成交速度快,立即成交。       | 可能成交价比实际的成交价格更高或更低。有滑点。 |
| 限价单 | 无滑点，可精准的控值成交价格,可避免滑点。 | 成交速度慢，或因为价格过高或过低无法成交。   |                   |

## 订单生效时间

- GTC(Good Till Cancelled): 订单一直有效，直到订单被取消。该模式通常为默认模式。
- GTD(Good Till Date): 订单一直有效，直到指定日期或被完全成交。
- GFD(Good For Day): 订单立即生效，直到当日结束。
- IOC(Immediate or Cancel): 订单必须立即生效，否则未成交部分将被取消。
- FOK(Fill or Kill): 订单必须完全成交，否则整个订单将被取消。

## 价格

交易所中通常有好几种价格类型

- 指数价格

指根据多个交易所价格计算出来的加权平均价格,作用是防止市场操纵行为。同时是对现货价格的反应。在交易所中,该数值不断地变化。

- 标记价格

用来计算未平仓合约的赢亏情况，避免强行平仓爆仓。它基于指数价格和资金费率的调整，目的是防止市场波动造成不必要的强制平仓。

- 最新价格

最新价格是交易所中当前价格，反映了当前市场上最后一笔交易。

- 强平价格(爆仓价格)Liquidation Price

强平价格是当仓位亏损时，系统根据当前价格计算出来的价格，如果价格低于强平价格，则该仓位将爆仓。

计算公式：`开仓价格 - 仓位方向 * 保证金 / 持仓数量 * 0.995`

ps: 0.995为扣除交易所的手续费之后的值,在实际中每个自交易所的手续费略有不同。

## 反向开仓

在单向持仓模式（One-Way
Mode）下，每个合约只能存在一个方向（多或空）且不可同时存在多空头寸。如果你下单的方向与当前持仓方向相反，系统会先执行减仓或平仓，如果成交量超出当前仓位，则自动开立反方向的新仓位，这就是“反向开仓”

优缺点：

| 优点                      | 缺点                                                                |
|-------------------------|-------------------------------------------------------------------|
| 你无需手动平仓再重新下单，系统自动一体化处理。 | 如果无意超量下反方向订单，可能不小心反手进入新的方向。不过许多平台提供“仅减仓”（Reduce Only）选项，避免反向开仓失控. |

示例说明:

1. 当前持有空头仓位，比如空 1 BTC。
2. 你再发起卖单（继续加仓空头）——属于同方向开仓。
3. 如果你发出买单，数量 ≤ 当前空头头寸（≤1 BTC）——这是减仓或平仓（部分或完全减少空头仓位）。
4. 如果买单数量 > 当前空头头寸，比如买 1.5 BTC：
    1. 系统会先买 1 BTC 来平掉空头；
    2. 剩下的 0.5 BTC 买单，将新开仓多头方向（反向开仓）

## 相关指标计算

**仓位方向**: 做多时仓位方向为+1,做空时仓位方向为-1. 仓位方向是为了计算盈亏场景使用。

**收益额**: ` = 仓位方向 * (当前价格 - 开仓价格) * 持仓量`

**收益率**: ` = 收益额 / 保证金 * 100%`

**最大开仓量**: `= 合约账户金额 * 杠杆倍数 / 币种价格`

**强平价格**：` = 开仓价格 - 仓位方向 * 保证金 / 持仓量 * 0.995`

# 专业名词

### 滑点

- 有滑点
- 无滑点

### 止盈/止损

### 保证金

### 抵押(Collateral)

### 清算(Liquidation)

### PNL(Profit and Loss) 盈亏

PNL通常来说代表盈亏. 也有的名称叫做`P&L`.

计算方式为

`总收入 - 总成本`

### 流动性(,LP)

# FQA

### 现货&合约的区别

https://www.bilibili.com/video/BV1pS4bejE2V

# 参考

## 文档

## 视频

- https://www.bilibili.com/video/BV1eaoCYFESa 基础概念
- https://www.bilibili.com/video/BV1t5o4YqE8Q 交易界面介绍
- https://www.bilibili.com/video/BV1MkoaY9EBr
- https://www.bilibili.com/video/BV1XT4y1s7Pi
- https://www.bilibili.com/video/BV1pS4bejE2V

## 社区论坛

- http://chanluntrader.com 缠乎